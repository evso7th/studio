(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{157:(e,i,r)=>{"use strict";r.d(i,{A:()=>s});var t=r(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return i.filter((e,i,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===i).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)((e,i)=>{let{color:r="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:s,className:c="",children:d,iconNode:m,...p}=e;return(0,t.createElement)("svg",{ref:i,...o,width:a,height:a,stroke:r,strokeWidth:s?24*Number(l)/Number(a):l,className:n("lucide",c),...p},[...m.map(e=>{let[i,r]=e;return(0,t.createElement)(i,r)}),...Array.isArray(d)?d:[d]])}),s=(e,i)=>{let r=(0,t.forwardRef)((r,o)=>{let{className:s,...c}=r;return(0,t.createElement)(l,{ref:o,iconNode:i,className:n("lucide-".concat(a(e)),s),...c})});return r.displayName="".concat(e),r}},599:(e,i,r)=>{"use strict";r.r(i),r.d(i,{default:()=>j});var t=r(5155),a=r(2115),n=r(5695);let o="/assets/images/platform_grass.png",l="/assets/images/platform_ice.png",s="/assets/images/platform_stone.png";var c=r(940);let d=(-.4+Math.sqrt(.4*.4+800))/2,m=e=>0,p={id:"hero",x:0,y:0,width:30,height:80,velocity:{x:0,y:0},action:"idle",isOnPlatform:!0,platformId:"platform_ground",currentSpeedX:0,facingDirection:"right",animations:{idle:{src:"/assets/images/hero_jeans3.png",frames:1,fps:1,width:30,height:80},run:{src:"/assets/images/hero_jeans3.png",frames:1,fps:10,width:30,height:80},jump:{src:"/assets/images/hero_jeans3.png",frames:1,fps:1,width:30,height:80}},currentFrame:0,frameTime:0,slideVelocityX:0,isArmored:!1,armorTimer:0,armorCooldownTimer:0,armorRemainingTime:0},h=(e,i,r)=>{let t=m(i),a=.75,n=!1,c=!1,d=o,p=o,h="/assets/images/groundfloor.png";return 1===r?(d=o,p=o,h="/assets/images/groundfloor.png"):2===r?(a=.75,n=!0,c=!0,d=l,p=l,h=l):3===r&&(a=.75,n=!1,c=!0,d=s,p=s,h=s),[{id:"platform_ground",x:-100,y:t,width:e+200,height:1,isMoving:!1,speed:0,direction:1,moveAxis:"x",imageSrc:h},{id:"platform1",x:0*e-0,y:t+1+200,width:130,height:24,isMoving:!0,speed:a,direction:1,moveAxis:"x",moveRange:{min:0,max:e-130},imageSrc:d,isSlippery:n},{id:"platform2",x:+e-130,y:t+1+400,width:130,height:24,isMoving:!0,speed:a,direction:-1,moveAxis:"x",moveRange:{min:0,max:e-130},imageSrc:p,isSlippery:c}]},g=(e,i,r,t)=>{let a=[],n=t.find(e=>"platform1"===e.id),o=t.find(e=>"platform2"===e.id),l=i/2-24;if(n&&o){let e=n.y+n.height;l=e+(o.y-e)/2-24}if(2===r)a.push({id:"enemy_level2_0",enemyId:"enemy1",x:e/2-24,y:l,width:48,height:48,imageSrc:"/assets/images/bearface.png",speed:.4,direction:1,moveAxis:"x",moveRange:{min:0,max:e-48},collisionRadius:24,isDefeated:!1,defeatTimer:0,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3});else if(3===r&&(a.push({id:"enemy_level3_0",enemyId:"enemy1",x:e/3-24,y:l,width:48,height:48,imageSrc:"/assets/images/bearface.png",speed:.4,direction:1,moveAxis:"x",moveRange:{min:0,max:e-48},collisionRadius:24,isDefeated:!1,defeatTimer:0,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3}),o)){let i=o.y+o.height+50;a.push({id:"enemy_level3_1",enemyId:"enemy2",x:2*e/3-24,y:i,width:48,height:48,imageSrc:"/assets/images/bearface_dark.png",speed:.4,direction:-1,moveAxis:"x",moveRange:{min:0,max:e-48},collisionRadius:24,isDefeated:!1,defeatTimer:0,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3})}return a};function u(e,i,r,t){let a,n;if(!e.width||!e.height||0===t.length)return[];let o=[];m(e.height);let l=550-i;200>=(l=Math.min(l,e.height-i))&&(console.warn("Coin spawn zone is invalid. Min:",200,"Max:",l,"GameArea H:",e.height,"CoinSize:",i,"MAX_COIN_SPAWN_Y_FROM_CP_TOP:",550),(l=200+i)+i>e.height-1&&(l=e.height-i-1-i)<200&&(l=200));let s=Math.max(0,l-200),c=.25*e.width,d=Math.max(20,.15*e.height),p=Math.random()*(e.width-i),h=200+(s>0?Math.random()*s:0);o.push({id:"coin_p".concat(r,"_0_").concat(Date.now()),x:p,y:h,width:i,height:i,collected:!1,isExploding:!1,explosionProgress:0,isSpawning:!0,spawnExplosionProgress:0,pairId:r,isPendingSpawn:!1,spawnDelayMs:0});let g=0;do a=Math.random()*(e.width-i),n=200+(s>0?Math.random()*s:0),g++;while((Math.abs(a-p)<c||Math.abs(n-h)<d)&&g<20);return o.push({id:"coin_p".concat(r,"_1_").concat(Date.now()),x:a,y:n,width:i,height:i,collected:!1,isExploding:!1,explosionProgress:0,isSpawning:!1,spawnExplosionProgress:0,pairId:r,isPendingSpawn:!0,spawnDelayMs:500}),o}let f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:800,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,t=m(i),a=h(e,i,r),n=g(e,i,r,a),o=.75;(2===r||3===r)&&(o=.75);let l=a.map(e=>e.isMoving?{...e,speed:o}:e),s=2===r?7e3:12e3*(3===r);return{hero:{...p,x:e/2-p.width/2,y:t+1,currentSpeedX:0,isArmored:2===r||3===r,armorTimer:s,armorCooldownTimer:0,armorRemainingTime:Math.ceil(s/1e3)},platforms:l,activeCoins:u({width:e,height:i},20,0,l),enemies:n,score:0,currentLevel:r,gameOver:!1,gameLost:!1,gameArea:{width:e,height:i},isGameInitialized:!1,paddingTop:0,heroAppearance:"appearing",heroAppearElapsedTime:0,totalCoinsCollectedInLevel:0,currentPairIndex:0,levelCompleteScreenActive:!1,showDebugLevelComplete:!1,bearVoicePlayedForLevel:!1}},v=f(void 0,void 0,1);function y(e,i){var r,t,a,n,o,l,s,y,x;switch(i.type){case"MOVE_LEFT_START":if("visible"===e.heroAppearance&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return{...e,hero:{...e.hero,currentSpeedX:-1.25,action:"run_left",facingDirection:"left",slideVelocityX:0}};return e;case"MOVE_LEFT_STOP":if("visible"===e.heroAppearance&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return{...e,hero:{...e.hero,currentSpeedX:e.hero.currentSpeedX<0?0:e.hero.currentSpeedX,action:0===e.hero.currentSpeedX&&e.hero.isOnPlatform&&(null!==(t=null===(r=e.hero.velocity)||void 0===r?void 0:r.y)&&void 0!==t?t:0)===0?"idle":e.hero.action}};return e;case"MOVE_RIGHT_START":if("visible"===e.heroAppearance&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return{...e,hero:{...e.hero,currentSpeedX:1.25,action:"run_right",facingDirection:"right",slideVelocityX:0}};return e;case"MOVE_RIGHT_STOP":if("visible"===e.heroAppearance&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return{...e,hero:{...e.hero,currentSpeedX:e.hero.currentSpeedX>0?0:e.hero.currentSpeedX,action:0===e.hero.currentSpeedX&&e.hero.isOnPlatform&&(null!==(n=null===(a=e.hero.velocity)||void 0===a?void 0:a.y)&&void 0!==n?n:0)===0?"idle":e.hero.action}};return e;case"JUMP":if("visible"===e.heroAppearance&&e.hero.isOnPlatform&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return c.W.playSound("Hero_jump1"),{...e,hero:{...e.hero,velocity:{...e.hero.velocity,y:d},isOnPlatform:!1,platformId:null,action:"jump_up"}};return e;case"UPDATE_GAME_AREA":{let{width:r,height:t,paddingTop:a}=i.payload;if(r<=0||t<=0)return e;let n=e.isGameInitialized?e.currentLevel:v.currentLevel||1,o=h(r,t,n),l=g(r,t,n,o),s=e.hero;s=e.isGameInitialized?{...e.hero,x:r/2-e.hero.width/2,y:m(t)+1,action:"idle",velocity:{x:0,y:0},isOnPlatform:!0,platformId:"platform_ground",isArmored:e.hero.isArmored,armorTimer:e.hero.armorTimer,armorCooldownTimer:e.hero.armorCooldownTimer,armorRemainingTime:e.hero.armorRemainingTime}:{...p,x:r/2-p.width/2,y:m(t)+1,isArmored:2===n||3===n,armorTimer:2===n?7e3:12e3*(3===n),armorRemainingTime:Math.ceil((2===n?7e3:12e3*(3===n))/1e3)};let c=e.activeCoins;return e.isGameInitialized&&e.gameArea.width===r&&e.gameArea.height===t||(c=u({width:r,height:t},20,0,o)),{...e,gameArea:{width:r,height:t},paddingTop:a,hero:s,platforms:o,enemies:l,activeCoins:c,score:e.isGameInitialized?e.score:0,totalCoinsCollectedInLevel:e.isGameInitialized?e.totalCoinsCollectedInLevel:0,currentPairIndex:e.isGameInitialized?e.currentPairIndex:0,isGameInitialized:!0,bearVoicePlayedForLevel:!!e.isGameInitialized&&e.bearVoicePlayedForLevel,heroAppearance:e.isGameInitialized?"visible":"appearing",heroAppearElapsedTime:1e3*!!e.isGameInitialized}}case"RESTART_LEVEL":{let{width:i,height:r}=e.gameArea;return{...f(i,r,e.currentLevel),isGameInitialized:!0,paddingTop:e.paddingTop,levelCompleteScreenActive:!1,gameOver:!1,bearVoicePlayedForLevel:!1}}case"NEXT_LEVEL":{let i=e.currentLevel+1;if(i>3)return c.W.playSound("final_screen"),{...e,gameOver:!0,levelCompleteScreenActive:!1};let{width:r,height:t}=e.gameArea;return{...f(r,t,i),isGameInitialized:!0,paddingTop:e.paddingTop,levelCompleteScreenActive:!1,gameOver:!1,bearVoicePlayedForLevel:!1}}case"GAME_WON":return c.W.playSound("final_screen"),{...e,gameOver:!0,levelCompleteScreenActive:!1};case"SET_DEBUG_LEVEL_COMPLETE":return{...e,levelCompleteScreenActive:i.payload,showDebugLevelComplete:i.payload};case"SET_DEBUG_LEVEL":{let{width:r,height:t}=e.gameArea,a=f(r,t,i.payload);return v=a,{...a,isGameInitialized:!0,paddingTop:e.paddingTop,levelCompleteScreenActive:!1,gameOver:!1,bearVoicePlayedForLevel:!1}}case"GAME_TICK":{if(!e.isGameInitialized||e.levelCompleteScreenActive||e.gameLost||e.gameOver)return e;let{deltaTime:r}=i.payload,{hero:t,platforms:a,activeCoins:n,enemies:d,score:p,totalCoinsCollectedInLevel:h,currentPairIndex:f,bearVoicePlayedForLevel:v}=e,w=e.gameArea,_=e.heroAppearance,A=e.heroAppearElapsedTime,T=a.map(e=>({...e})),b={...t,velocity:{...t.velocity},animations:{...t.animations}},S=n.map(e=>({...e})),E=[...d.map(e=>({...e}))],L=p,C=h,M=f,I=!1,P=!1,k=!1,z=v,O=!1;(2===e.currentLevel||3===e.currentLevel)&&(b.isArmored?(b.armorTimer-=r,b.armorTimer<=0&&(b.isArmored=!1,b.armorTimer=0,b.armorCooldownTimer=2===e.currentLevel?7e3:1e4)):(b.armorCooldownTimer-=r,b.armorCooldownTimer<=0&&(b.isArmored=!0,b.armorCooldownTimer=0,b.armorTimer=2===e.currentLevel?7e3:12e3)),b.armorRemainingTime=Math.ceil(b.armorTimer/1e3));let j="run_left"===b.action||"run_right"===b.action?"run":"jump_up"===b.action||"fall_down"===b.action?"jump":"idle",R=b.animations[j];b.frameTime+=r,R&&b.frameTime>=1e3/R.fps&&(b.frameTime=0,b.currentFrame=(b.currentFrame+1)%R.frames),S=(S=S.map(e=>{let i={...e};if(i.isPendingSpawn&&void 0!==i.spawnDelayMs){let e=i.spawnDelayMs-r;e<=0?(O=!0,i={...i,isPendingSpawn:!1,spawnDelayMs:0,isSpawning:!0,spawnExplosionProgress:0}):i.spawnDelayMs=e}if(i.isSpawning){let e=(i.spawnExplosionProgress||0)+r/300;e>=1?(i.isSpawning=!1,i.spawnExplosionProgress=1):i.spawnExplosionProgress=e}return i})).map(e=>{if(e.isExploding&&e.collected){let i=(e.explosionProgress||0)+r/500;return i>=1?{...e,isExploding:!1,explosionProgress:1}:{...e,explosionProgress:i}}return e});let F=m(w.height);if(T=T.map(e=>{if("platform_ground"===e.id)return{...e,y:F};if(e.isMoving&&"platform_ground"!==e.id){let i=e.x,t=e.speed,a=t*e.direction;"x"===e.moveAxis&&e.moveRange&&((i+=r/(1e3/60)*a)<=e.moveRange.min||i+e.width>=e.moveRange.max+e.width)&&(e.direction*=-1,a*=-1,i=Math.max(e.moveRange.min,Math.min(i,e.moveRange.max)));let n=F+1+("platform1"===e.id?200:400);return{...e,x:i,y:n,velocity:{x:a,y:0},speed:t}}return{...e,velocity:{x:0,y:0}}}),E=E.map(i=>{let t={...i},a=e.enemies.find(e=>e.id===i.id);if(t.isDefeated&&void 0!==t.defeatTimer){let e=t.defeatTimer-r;if(!(e<=0))return{...t,defeatTimer:e};t={...t,isDefeated:!1,defeatTimer:0,x:w.width/2-t.width/2,y:t.y,direction:1,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3},a&&a.isDefeated&&!t.isDefeated&&c.W.playSound("bear_voice")}if(t.isFrozen&&void 0!==t.frozenTimer){let e=t.frozenTimer-r;if(!(e<=0))return{...t,frozenTimer:e};t={...t,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3}}if(!t.isDefeated&&!t.isFrozen&&void 0!==t.periodicFreezeIntervalTimer){let e=t.periodicFreezeIntervalTimer-r;if(e<=0)return{...t,isFrozen:!0,frozenTimer:5e3,periodicFreezeIntervalTimer:5e3};t={...t,periodicFreezeIntervalTimer:e}}if(!t.isDefeated&&!t.isFrozen){let e=t.x,i=t.speed,a=i*t.direction;if("x"===t.moveAxis&&t.moveRange&&((e+=r/(1e3/60)*a)<=t.moveRange.min||e+t.width>=t.moveRange.max+t.width)){let i=-1*t.direction;a*=-1,e=Math.max(t.moveRange.min,Math.min(e,t.moveRange.max)),t={...t,direction:i}}t={...t,x:e,velocity:{x:a,y:0},speed:i}}return t}),"appearing"===e.heroAppearance)(A+=r)>=1e3&&(_="visible",A=1e3,b.action="idle"),b.velocity={x:0,y:0},b.currentSpeedX=0,b.facingDirection=t.facingDirection||"right",b.slideVelocityX=0;else{let i;let t=(null!==(s=null===(o=b.velocity)||void 0===o?void 0:o.y)&&void 0!==s?s:0)-r/(1e3/60)*.4;t=Math.max(t,-8);let a=0,n=!1;if(b.isOnPlatform&&b.platformId){let e=T.find(e=>e.id===b.platformId);e&&(e.isMoving&&(null===(y=e.velocity)||void 0===y?void 0:y.x)&&(a=e.velocity.x*(r/(1e3/60))),e.isSlippery&&(n=!0))}let d=0!==b.currentSpeedX?b.currentSpeedX>0?1.25:-1.25:0;n?(0!==b.currentSpeedX?b.slideVelocityX=d:(b.slideVelocityX=.92*(b.slideVelocityX||0),.1>Math.abs(b.slideVelocityX||0)&&(b.slideVelocityX=0)),i=b.x+(b.slideVelocityX||0)*(r/(1e3/60))+a):(b.slideVelocityX=0,i=b.x+r/(1e3/60)*d+a);let m=b.y+r/(1e3/60)*t;t<-.2?b.action="fall_down":t>0?b.action="jump_up":0!==b.currentSpeedX&&b.isOnPlatform?b.action="right"===b.facingDirection?"run_right":"run_left":b.isOnPlatform&&(0===b.slideVelocityX||!n)?b.action="idle":b.isOnPlatform&&n&&0!==b.slideVelocityX&&(b.action=b.slideVelocityX>0?"run_right":"run_left");let p=!1,h=null,v=t,j=b.y;for(let e of T){let r=i,t=i+b.width,a=m,n=m+b.height,o=e.y+e.height,l=e.y,s=e.x;if(r<e.x+e.width&&t>s){if(v<=0&&j>=o&&a<=o){m=o,v=0,p=!0,h=e.id,("fall_down"===b.action||"jump_up"===b.action)&&(b.action=0!==b.currentSpeedX?"right"===b.facingDirection?"run_right":"run_left":"idle",e.isSlippery&&0===b.currentSpeedX||e.isSlippery||(b.slideVelocityX=0));break}let i=b.y+b.height;v>0&&i<=l&&n>=l&&(m=l-b.height,v=-.2)}}if(b.x=i,b.y=m,b.velocity={x:null!==(x=null===(l=b.velocity)||void 0===l?void 0:l.x)&&void 0!==x?x:0,y:v},b.isOnPlatform=p,b.platformId=h,b.isOnPlatform){let e=T.find(e=>e.id===b.platformId);(null==e?void 0:e.isSlippery)?0===b.currentSpeedX&&.1>Math.abs(b.slideVelocityX||0)?b.action="idle":Math.abs(b.slideVelocityX||0)>=.1&&(b.action=(b.slideVelocityX||0)>0?"run_right":"run_left"):0===b.currentSpeedX&&0===v?b.action="idle":0!==b.currentSpeedX&&0===v&&(b.action="right"===b.facingDirection?"run_right":"run_left")}else v>0?b.action="jump_up":v<-.2&&(b.action="fall_down");b.x<0&&(b.x=0),b.x+b.width>w.width&&(b.x=w.width-b.width),b.y+b.height>w.height&&(b.y=w.height-b.height,b.velocity&&b.velocity.y>0&&(b.velocity.y=0));for(let i=0;i<E.length;i++){let r=E[i];if(r.isDefeated||r.isFrozen)continue;let t=r.x+r.width/2,a=r.y+r.height/2,n=Math.max(b.x,Math.min(t,b.x+b.width)),o=Math.max(b.y,Math.min(a,b.y+b.height)),l=t-n,s=a-o;if(l*l+s*s<r.collisionRadius*r.collisionRadius){b.isArmored||(k=!0,c.W.playSound("Hero_fail"));let t=e.enemies.find(e=>e.id===r.id);t&&!t.isDefeated&&c.W.playSound("bear_voice"),E[i]={...r,isDefeated:!0,defeatTimer:5e3,isFrozen:!1,frozenTimer:0},b.isArmored&&(k=!1);break}}k&&!b.isArmored&&(b.y=F+1,b.x=w.width/2-b.width/2,b.velocity={x:0,y:0},b.isOnPlatform=!0,b.platformId="platform_ground",b.action="idle",_="appearing",A=0,b.slideVelocityX=0);let R=!1,V=0;if(!k||k&&b.isArmored){S=S.map(e=>!e.collected&&!e.isExploding&&!e.isSpawning&&!e.isPendingSpawn&&b.x<e.x+e.width&&b.x+b.width>e.x&&b.y<e.y+e.height&&b.y+b.height>e.y?(R=!0,V++,c.W.playSound("takecoin"),{...e,collected:!0,isExploding:!0,explosionProgress:0}):e);let i=!1;if(R){L+=V;let r=C;if(C+=V,2===e.currentLevel&&0===r&&C>0&&!E.some(e=>"enemy_level2_0"===e.id&&!e.isDefeated)&&!E.find(e=>"enemy_level2_0"===e.id)){let i=g(w.width,w.height,e.currentLevel,T).find(e=>"enemy_level2_0"===e.id);i&&(z||(c.W.playSound("bear_voice"),z=!0),E.push(i))}if(3===e.currentLevel&&0===r&&C>0&&0===E.filter(e=>e.id.startsWith("enemy_level3_")&&!e.isDefeated).length){let i=g(w.width,w.height,e.currentLevel,T),r=!1;i.forEach(e=>{E.some(i=>i.id===e.id)||(E.push(e),r=!0)}),r&&!z&&(c.W.playSound("bear_voice"),z=!0)}if(2===e.currentLevel)E=E.map(e=>"enemy_level2_0"!==e.id||e.isDefeated?e:{...e,isFrozen:!0,frozenTimer:5e3});else if(3===e.currentLevel){let e=C%2==0;E=E.map(i=>("enemy1"!==i.enemyId||!e||i.isDefeated)&&("enemy2"!==i.enemyId||e||i.isDefeated)?i:{...i,isFrozen:!0,frozenTimer:5e3})}let t=S.filter(e=>e.pairId===f);t.length>0&&t.every(e=>e.collected)&&(C<10?(M=f+1,i=!0):(I=!0,c.W.playSound("allcoins")))}S=S.filter(e=>!(e.collected&&!1===e.isExploding&&1===e.explosionProgress)),i&&(S=[...S,...u(w,20,M,T)],O=!0)}O&&c.W.playSound("Coin_splash"),!(b.y<0)||I||k&&!b.isArmored||(P=!0,c.W.playSound("Hero_fail"))}let V=e.gameOver,D=e.levelCompleteScreenActive;return!I||k&&!b.isArmored||P||(3===e.currentLevel?V=!0:D=!0),{...e,hero:b,platforms:T,activeCoins:S,enemies:E,score:L,totalCoinsCollectedInLevel:C,currentPairIndex:M,heroAppearance:_,heroAppearElapsedTime:A,gameOver:V,gameLost:P&&!(k&&!b.isArmored),levelCompleteScreenActive:D,bearVoicePlayedForLevel:z}}case"EXIT_GAME":return{...v=f(e.gameArea.width,e.gameArea.height,1),gameOver:!1,gameLost:!1,levelCompleteScreenActive:!1};default:return e}}var x=r(285),w=r(157);let _=(0,w.A)("CircleArrowLeft",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 12H8",key:"1fr5h0"}],["path",{d:"m12 8-4 4 4 4",key:"15vm53"}]]),A=(0,w.A)("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),T=(0,w.A)("CircleArrowRight",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}]]),b=(0,w.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);function S(e){let{dispatch:i,onExit:r,disabled:a=!1,currentLevel:n}=e,o=e=>{a||i({type:e})},l=e=>{a||i({type:e})},s=e=>{i({type:e})},c="p-3 h-16 w-16 rounded-full text-foreground shadow-lg hover:shadow-xl active:shadow-lg active:translate-y-px transition-all duration-150 ease-in-out",d="disabled:opacity-70 disabled:bg-transparent disabled:border disabled:border-destructive disabled:text-destructive disabled:shadow-none disabled:cursor-not-allowed",m=e=>e?{}:{backgroundImage:"radial-gradient(circle, hsl(var(--destructive)), #e74210, #f48c25 )"};return(0,t.jsxs)("div",{className:"h-full w-full p-2 flex items-center justify-around z-50 touch-manipulation",style:{backgroundImage:(e=>{switch(e){case 1:default:return'url("/assets/images/groundfloor.png")';case 2:return'url("/assets/images/platform_ice.png")';case 3:return'url("/assets/images/platform_metal.png")'}})(n),backgroundSize:"cover",backgroundPosition:"center left",backgroundRepeat:"no-repeat",backgroundColor:"transparent"},"data-ai-hint":"stone texture",children:[(0,t.jsx)(x.$,{variant:"ghost",size:"lg",className:"".concat(c," ").concat(a?d:""),style:m(a),onMouseDown:()=>l("MOVE_LEFT_START"),onMouseUp:()=>s("MOVE_LEFT_STOP"),onTouchStart:()=>l("MOVE_LEFT_START"),onTouchEnd:()=>s("MOVE_LEFT_STOP"),"aria-label":"Move Left",disabled:a,children:(0,t.jsx)(_,{className:"h-12 w-12 text-foreground"})}),(0,t.jsx)(x.$,{variant:"ghost",size:"lg",className:"".concat(c," ").concat(a?d:""),style:m(a),onClick:()=>o("JUMP"),"aria-label":"Jump",disabled:a,children:(0,t.jsx)(A,{className:"h-12 w-12 text-foreground"})}),(0,t.jsx)(x.$,{variant:"ghost",size:"lg",className:"".concat(c," ").concat(a?d:""),style:m(a),onMouseDown:()=>l("MOVE_RIGHT_START"),onMouseUp:()=>s("MOVE_RIGHT_STOP"),onTouchStart:()=>l("MOVE_RIGHT_START"),onTouchEnd:()=>s("MOVE_RIGHT_STOP"),"aria-label":"Move Right",disabled:a,children:(0,t.jsx)(T,{className:"h-12 w-12 text-foreground"})}),(0,t.jsx)(x.$,{variant:"ghost",size:"lg",className:"".concat(c," ").concat(a?d:""),style:m(a),onClick:r,"aria-label":"Выход в меню",disabled:a,children:(0,t.jsx)(b,{className:"h-12 w-12 text-foreground"})})]})}var E=r(9434);function L(e){let{x:i,y:r,width:t,height:a,gameAreaHeight:n,paddingTop:o,color:l,heroAction:s,heroFacingDirection:c,appearanceProps:d,shape:m="rect",isHero:p=!1,isPlatform:h=!1,isEnemy:g=!1}=e,u={position:"absolute",left:"".concat(i,"px"),top:"".concat(o+(n-r-a),"px"),width:"".concat(t,"px"),height:"".concat(a,"px"),objectFit:"fill",transition:"opacity 0.2s ease-out, transform 0.2s ease-out, filter 0.2s ease-out"};l&&!g&&(u.backgroundColor=l);let f="";p&&(f="left"===c?"scaleX(-1)":"scaleX(1)");let v="";if((null==d?void 0:d.type)==="heroAppear"){let e=d.progress;u.opacity=e,v="scale(".concat(e,")"),u.transformOrigin="center bottom",u.borderRadius="2px"}else if("circle"===m?u.borderRadius="50%":g||(u.borderRadius="2px"),s)switch(s){case"jump_up":v="scaleY(0.95) translateY(-3px) scaleX(1.05)",u.transition="transform 0.1s ease-out";break;case"fall_down":v="scaleY(1.05) translateY(1px) scaleX(0.95)",u.transition="transform 0.1s ease-in";break;default:v=""}let y="".concat(f," ").concat(v).trim();return y&&(u.transform=y),u}function C(e){let i,{hero:r,gameAreaHeight:a,paddingTop:n,heroAppearance:o,heroAppearElapsedTime:l,heroAppearanceDuration:s}=e;if(!a&&0!==a)return null;"appearing"===o&&(i={type:"heroAppear",progress:Math.min(1,l/s)});let c=r.animations.idle.src,d=r.animations.run.src,m=r.animations.jump.src,p=c,h="character fantasy";"run_left"===r.action||"run_right"===r.action?(p=d,h="character running"):("jump_up"===r.action||"fall_down"===r.action)&&(p=m,h="character jumping");let g=L({...r,gameAreaHeight:a,paddingTop:n,heroAction:r.action,heroFacingDirection:r.facingDirection,appearanceProps:i,isHero:!0}),u=[];return r.isArmored&&u.push("hero-armored"),(0,t.jsx)("img",{src:p,alt:"Hero",style:g,className:(0,E.cn)(u),role:"img","aria-label":"Hero","data-ai-hint":h})}function M(e){let{platform:i,gameAreaHeight:r,paddingTop:a}=e;if(!r&&0!==r)return null;let n={...L({...i,gameAreaHeight:r,paddingTop:a,color:void 0,shape:"rect",isPlatform:!0}),backgroundImage:"url(".concat(i.imageSrc||o,")"),backgroundSize:"platform_ground"===i.id?"auto 100%":"100% 100%",backgroundPosition:"platform_ground"===i.id?"left bottom":"center",backgroundRepeat:"platform_ground"===i.id?"repeat-x":"no-repeat",boxShadow:"none",border:"none"},l="grass platform";return i.imageSrc&&(i.imageSrc.includes("groundfloor")?l="stone ground":i.imageSrc.includes("ice")?l="ice platform":i.imageSrc.includes("stone")?l="stone platform":i.imageSrc.includes("grass")&&(l="grass platform")),(0,t.jsx)("div",{style:n,role:"presentation","data-ai-hint":l})}function I(e){let{coin:i,gameAreaHeight:r,paddingTop:a}=e;if(!r&&0!==r)return null;let n=L({...i,gameAreaHeight:r,paddingTop:a,shape:"circle"});if(i.isSpawning&&null!=i.spawnExplosionProgress&&i.spawnExplosionProgress<1){let e=[];for(let r=0;r<8;r++){let a=r/8*2*Math.PI+(Math.random()-.5)*.5,n=40*i.spawnExplosionProgress*(.5+.5*Math.random()),o=Math.cos(a)*n,l=Math.sin(a)*n,s={position:"absolute",left:"calc(50% + ".concat(o,"px - ").concat(2.5,"px)"),top:"calc(50% + ".concat(l,"px - ").concat(2.5,"px)"),width:"".concat(5,"px"),height:"".concat(5,"px"),backgroundColor:"hsl(var(--accent))",borderRadius:"50%",opacity:1-i.spawnExplosionProgress,transform:"scale(".concat(1-i.spawnExplosionProgress,")"),transition:"opacity 0.1s ease-out, transform 0.1s ease-out"};e.push((0,t.jsx)("div",{style:s},"spawn_particle_".concat(r)))}let r={position:"absolute",left:n.left,top:n.top,width:n.width,height:n.height};return(0,t.jsx)("div",{style:r,"aria-label":"Coin Spawning","data-ai-hint":"sparkle effect",children:e})}if(i.isExploding&&i.collected&&null!=i.explosionProgress&&i.explosionProgress<1){let e=[];for(let r=0;r<8;r++){let a=r/8*2*Math.PI+(Math.random()-.5)*.5,n=40*i.explosionProgress*(.5+.5*Math.random()),o=Math.cos(a)*n,l=Math.sin(a)*n,s={position:"absolute",left:"calc(50% + ".concat(o,"px - ").concat(2.5,"px)"),top:"calc(50% + ".concat(l,"px - ").concat(2.5,"px)"),width:"".concat(5,"px"),height:"".concat(5,"px"),backgroundColor:"hsl(var(--coin-color))",borderRadius:"50%",opacity:1-i.explosionProgress,transform:"scale(".concat(1-i.explosionProgress,")"),transition:"opacity 0.1s ease-out, transform 0.1s ease-out"};e.push((0,t.jsx)("div",{style:s},"collect_particle_".concat(r)))}let r={position:"absolute",left:n.left,top:n.top,width:n.width,height:n.height};return(0,t.jsx)("div",{style:r,"aria-label":"Coin Exploding","data-ai-hint":"gold sparkle",children:e})}return i.collected||i.isSpawning?null:(0,t.jsx)("img",{src:"/assets/images/thankscoin.png",alt:"Coin",className:"animate-rotate-y",style:{...n,transformStyle:"preserve-3d",boxShadow:"2px 2px 3px rgba(0,0,0,0.2), inset 0 0 2px rgba(255,255,255,0.3)"},role:"img","aria-label":"Coin","data-ai-hint":"gold coin"})}function P(e){let{enemy:i,gameAreaHeight:r,paddingTop:a}=e;if(!r&&0!==r||i.isDefeated&&i.defeatTimer>0)return null;let n=L({...i,gameAreaHeight:r,paddingTop:a,isEnemy:!0,isDefeated:i.isDefeated});return(0,t.jsx)("img",{src:i.imageSrc,alt:"Enemy",style:n,role:"img","aria-label":"Enemy","data-ai-hint":"enemy2"===i.enemyId?"dark bear face":"bear face"})}var k=r(6364),z=r(1575),O=r(10);function j(){var e;let{gameState:i,dispatch:r,gameTick:o}=function(){let[e,i]=(0,a.useReducer)(y,v),r=(0,a.useRef)(performance.now()),t=(0,a.useCallback)(()=>{let e=performance.now(),t=e-r.current;r.current=e,i({type:"GAME_TICK",payload:{deltaTime:t}})},[]),n=(0,a.useCallback)(e=>{i(e)},[]);return(0,a.useEffect)(()=>{e.gameArea.width>0&&e.gameArea.height>0&&!e.isGameInitialized&&i({type:"UPDATE_GAME_AREA",payload:{width:e.gameArea.width,height:e.gameArea.height,paddingTop:e.paddingTop}})},[e.gameArea.width,e.gameArea.height,e.isGameInitialized,e.paddingTop,i]),{gameState:e,dispatch:n,gameTick:t}}(),l=(0,a.useRef)(null),s=(0,a.useRef)(),d=(0,n.useRouter)(),[m,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),[u,f]=(0,a.useState)({width:0,height:0}),[w,_]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=()=>{l.current&&(f({width:l.current.clientWidth,height:l.current.clientHeight}),_(0))};e(),window.addEventListener("resize",e);let i=()=>e();return document.addEventListener("fullscreenchange",i),document.addEventListener("webkitfullscreenchange",i),document.addEventListener("mozfullscreenchange",i),document.addEventListener("MSFullscreenChange",i),()=>{window.removeEventListener("resize",e),document.removeEventListener("fullscreenchange",i),document.removeEventListener("webkitfullscreenchange",i),document.removeEventListener("mozfullscreenchange",i),document.removeEventListener("MSFullscreenChange",i),s.current&&cancelAnimationFrame(s.current),c.W.stopAllSounds()}},[]),(0,a.useEffect)(()=>{u.width>0&&u.height>0&&r({type:"UPDATE_GAME_AREA",payload:{width:u.width,height:u.height,paddingTop:w}})},[u,w,r]),(0,a.useEffect)(()=>{if(i.isGameInitialized){c.W.stopAllSounds(),c.W.playSound("New_level");let e={1:"Level1",2:"Level2",3:"Level3"}[i.currentLevel];e&&c.W.getCurrentPlayingLoop()!==e&&setTimeout(()=>{i.isGameInitialized&&i.currentLevel===parseInt(e.replace("Level",""))&&c.W.playSound(e)},500)}},[i.currentLevel,i.isGameInitialized]),(0,a.useEffect)(()=>{i.isGameInitialized&&i.activeCoins.length>0&&0===i.currentPairIndex&&i.activeCoins.some(e=>0===e.pairId&&e.isSpawning)},[i.isGameInitialized,i.activeCoins,i.currentPairIndex]);let A=(0,a.useCallback)(()=>{!i.isGameInitialized||!(i.gameArea.width>0)||!(i.gameArea.height>0)||i.levelCompleteScreenActive||i.gameOver||i.gameLost||h||o(),s.current=requestAnimationFrame(A)},[o,i.isGameInitialized,i.gameArea.width,i.gameArea.height,i.levelCompleteScreenActive,i.gameOver,i.gameLost,h]);(0,a.useEffect)(()=>(h?s.current&&cancelAnimationFrame(s.current):s.current=requestAnimationFrame(A),()=>{s.current&&cancelAnimationFrame(s.current)}),[A,h]),(0,a.useEffect)(()=>{let e=e=>{if(m||"appearing"===i.heroAppearance||i.levelCompleteScreenActive||i.gameLost||i.gameOver||"F5"===e.key||e.ctrlKey&&"r"===e.key.toLowerCase()||e.ctrlKey&&e.shiftKey&&"i"===e.key.toLowerCase()||e.metaKey&&e.altKey&&"i"===e.key.toLowerCase()||"F12"===e.key)return;let t=!1;switch(e.key.toLowerCase()){case"arrowleft":case"a":r({type:"MOVE_LEFT_START"}),t=!0;break;case"arrowright":case"d":r({type:"MOVE_RIGHT_START"}),t=!0;break;case"arrowup":case"w":case" ":r({type:"JUMP"}),t=!0}t&&e.preventDefault()},t=e=>{if(m||"appearing"===i.heroAppearance||i.levelCompleteScreenActive||i.gameLost||i.gameOver)return;let t=!1;switch(e.key.toLowerCase()){case"arrowleft":case"a":r({type:"MOVE_LEFT_STOP"}),t=!0;break;case"arrowright":case"d":r({type:"MOVE_RIGHT_STOP"}),t=!0}t&&e.preventDefault()};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),r({type:"MOVE_LEFT_STOP"}),r({type:"MOVE_RIGHT_STOP"})}},[r,i.heroAppearance,i.levelCompleteScreenActive,i.gameLost,i.gameOver,m]);let T=async()=>{c.W.stopAllSounds(),c.W.playSound("exit"),p(!1),g(!1),setTimeout(()=>{d.push("/")},300)},b=()=>{p(!1),g(!1)};return i.gameLost?(0,t.jsxs)("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-background text-foreground p-4",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold mb-4 text-destructive",children:"Игра окончена!"}),(0,t.jsx)("p",{className:"text-xl mb-8 text-center",children:"Кажется, наш герой немного увлекся полетом..."}),(0,t.jsx)(x.$,{onClick:()=>{c.W.stopAllSounds(),r({type:"RESTART_LEVEL"})},size:"lg",className:"text-lg px-8 py-3 bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:"Начать сначала"}),(0,t.jsx)(x.$,{onClick:T,variant:"outline",size:"lg",className:"mt-4 text-lg px-8 py-3 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:"Главное меню"})]}):i.levelCompleteScreenActive||i.showDebugLevelComplete?(0,t.jsx)(k.M,{currentLevel:i.currentLevel,onNextLevel:()=>{c.W.stopAllSounds(),r({type:"NEXT_LEVEL"}),i.showDebugLevelComplete&&r({type:"SET_DEBUG_LEVEL_COMPLETE",payload:!1})}}):i.gameOver&&3===i.currentLevel&&!i.gameLost?(0,t.jsx)(z.V,{}):(0,t.jsxs)("div",{className:"h-screen w-screen flex flex-col overflow-hidden select-none",style:{backgroundColor:"hsl(var(--background))",paddingBottom:0,boxSizing:"border-box"},"aria-label":"Главное окно игры",children:[(0,t.jsxs)("header",{className:"absolute top-0 left-0 right-0 p-4 flex justify-between items-center z-10 pointer-events-none",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-roboto text-2xl font-bold text-white shadow-md",children:"IPO Mad Racing"}),(null===(e=i.hero)||void 0===e?void 0:e.isArmored)&&i.hero.armorRemainingTime>0&&(0,t.jsxs)("p",{className:"text-xs font-normal text-accent font-roboto shadow-md",children:["Броня: ",i.hero.armorRemainingTime,"с"]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-end",children:[(0,t.jsxs)("p",{className:"text-xs font-normal text-white font-roboto shadow-md",children:["Level: ",i.currentLevel]}),(0,t.jsxs)("p",{className:"text-xs font-normal text-white font-roboto shadow-md",children:["Спасибки: ",i.score]})]})]}),(0,t.jsx)("div",{ref:l,className:"relative w-full overflow-hidden flex-grow bg-cover bg-no-repeat",style:{backgroundImage:"url(".concat((e=>{switch(e){case 1:default:return"/assets/images/level1_bkg.png";case 2:return"/assets/images/level2_bkg.png";case 3:return"/assets/images/level3_bkg.png"}})(i.currentLevel),")"),backgroundSize:"cover",backgroundPosition:"center center",height:"90vh"},"data-ai-hint":"abstract pattern",children:i.isGameInitialized&&u.height>0&&i.hero&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C,{hero:i.hero,gameAreaHeight:u.height,paddingTop:w,heroAppearance:i.heroAppearance,heroAppearElapsedTime:i.heroAppearElapsedTime,heroAppearanceDuration:1e3}),i.platforms.map(e=>(0,t.jsx)(M,{platform:e,gameAreaHeight:u.height,paddingTop:w},e.id)),i.activeCoins.map(e=>(0,t.jsx)(I,{coin:e,gameAreaHeight:u.height,paddingTop:w},e.id)),i.enemies.map(e=>(0,t.jsx)(P,{enemy:e,gameAreaHeight:u.height,paddingTop:w},e.id))]})}),(0,t.jsx)(O.Lt,{open:m,onOpenChange:e=>{!e&&h?b():e&&!m&&(p(!0),g(!0))},children:(0,t.jsxs)(O.EO,{children:[(0,t.jsxs)(O.wd,{className:"items-center",children:[(0,t.jsx)("div",{className:"relative w-24 h-24 mb-4 bg-contain bg-no-repeat bg-center",style:{backgroundImage:"url(/assets/images/SimplyMan.png)"},role:"img","aria-label":"Simply Man","data-ai-hint":"man thinking cartoon"}),(0,t.jsx)(O.r7,{children:"Вы действительно хотите покинуть игру?"})]}),(0,t.jsxs)(O.ck,{className:"flex-col-reverse sm:flex-col-reverse gap-y-2.5",children:[(0,t.jsx)(x.$,{variant:"destructive",onClick:b,className:"w-full sm:w-auto",children:"Нет, остаться"}),(0,t.jsx)(x.$,{variant:"secondary",onClick:T,className:"w-full sm:w-auto",children:"Да, покинуть"})]})]})}),(0,t.jsxs)("div",{className:"w-full shrink-0",style:{height:"10vh"},children:["  ",(0,t.jsx)(S,{dispatch:r,onExit:()=>{g(!0),p(!0)},disabled:"appearing"===i.heroAppearance||i.levelCompleteScreenActive||i.gameLost||i.gameOver||m,currentLevel:i.currentLevel})]})]})}},3738:(e,i,r)=>{Promise.resolve().then(r.bind(r,599))}},e=>{var i=i=>e(e.s=i);e.O(0,[797,576,933,441,684,358],()=>i(3738)),_N_E=e.O()}]);