(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{157:(e,r,i)=>{"use strict";i.d(r,{A:()=>s});var t=i(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return r.filter((e,r,i)=>!!e&&""!==e.trim()&&i.indexOf(e)===r).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)((e,r)=>{let{color:i="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:s,className:c="",children:d,iconNode:m,...p}=e;return(0,t.createElement)("svg",{ref:r,...n,width:a,height:a,stroke:i,strokeWidth:s?24*Number(l)/Number(a):l,className:o("lucide",c),...p},[...m.map(e=>{let[r,i]=e;return(0,t.createElement)(r,i)}),...Array.isArray(d)?d:[d]])}),s=(e,r)=>{let i=(0,t.forwardRef)((i,n)=>{let{className:s,...c}=i;return(0,t.createElement)(l,{ref:n,iconNode:r,className:o("lucide-".concat(a(e)),s),...c})});return i.displayName="".concat(e),i}},599:(e,r,i)=>{"use strict";i.r(r),i.d(r,{default:()=>I});var t=i(5155),a=i(2115),o=i(5695);let n="/assets/images/platform_grass.png",l="/assets/images/platform_ice.png",s="/assets/images/platform_stone.png";var c=i(940);let d=(-.4+Math.sqrt(.4*.4+800))/2,m=e=>0,p={id:"hero",x:0,y:0,width:30,height:80,velocity:{x:0,y:0},action:"idle",isOnPlatform:!0,platformId:"platform_ground",currentSpeedX:0,facingDirection:"right",animations:{idle:{src:"/assets/images/hero_jeans3.png",frames:1,fps:1,width:30,height:80},run:{src:"/assets/images/hero_jeans3.png",frames:1,fps:10,width:30,height:80},jump:{src:"/assets/images/hero_jeans3.png",frames:1,fps:1,width:30,height:80}},currentFrame:0,frameTime:0,slideVelocityX:0,isArmored:!1,armorTimer:0,armorCooldownTimer:0,armorRemainingTime:0},h=(e,r,i)=>{let t=m(r),a=.75,o=!1,c=!1,d=n,p=n,h="/assets/images/groundfloor.png";return 1===i?(d=n,p=n,h="/assets/images/groundfloor.png"):2===i?(a=.75,o=!0,c=!0,d=l,p=l,h=l):3===i&&(a=.75,o=!0,c=!0,d=s,p=s,h=s),[{id:"platform_ground",x:-100,y:t,width:e+200,height:1,isMoving:!1,speed:0,direction:1,moveAxis:"x",imageSrc:h},{id:"platform1",x:0*e-0,y:t+1+200,width:130,height:24,isMoving:!0,speed:a,direction:1,moveAxis:"x",moveRange:{min:0,max:e-130},imageSrc:d,isSlippery:o},{id:"platform2",x:+e-130,y:t+1+400,width:130,height:24,isMoving:!0,speed:a,direction:-1,moveAxis:"x",moveRange:{min:0,max:e-130},imageSrc:p,isSlippery:c}]},g=(e,r,i,t)=>{let a=[],o=t.find(e=>"platform1"===e.id),n=t.find(e=>"platform2"===e.id),l=r/2-24;if(o&&n){let e=o.y+o.height;l=e+(n.y-e)/2-24}if(2===i)a.push({id:"enemy_level2_0",enemyId:"enemy1",x:e/2-24,y:l,width:48,height:48,imageSrc:"/assets/images/bearface.png",speed:.4,direction:1,moveAxis:"x",moveRange:{min:0,max:e-48},collisionRadius:24,isDefeated:!1,defeatTimer:0,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3});else if(3===i&&(a.push({id:"enemy_level3_0",enemyId:"enemy1",x:e/3-24,y:l,width:48,height:48,imageSrc:"/assets/images/bearface.png",speed:.4,direction:1,moveAxis:"x",moveRange:{min:0,max:e-48},collisionRadius:24,isDefeated:!1,defeatTimer:0,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3}),n)){let r=n.y+n.height+50;a.push({id:"enemy_level3_1",enemyId:"enemy2",x:2*e/3-24,y:r,width:48,height:48,imageSrc:"/assets/images/bearface_dark.png",speed:.4,direction:-1,moveAxis:"x",moveRange:{min:0,max:e-48},collisionRadius:24,isDefeated:!1,defeatTimer:0,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3})}return a};function u(e,r,i,t){let a,o;if(!e.width||!e.height||0===t.length)return[];c.W.playSound("Coin_splash");let n=[];m(e.height);let l=550-r;200>=(l=Math.min(l,e.height-r))&&(console.warn("Coin spawn zone is invalid. Min:",200,"Max:",l,"GameArea H:",e.height,"CoinSize:",r,"MAX_COIN_SPAWN_Y_FROM_CP_TOP:",550),(l=200+r)+r>e.height-1&&(l=e.height-r-1-r)<200&&(l=200));let s=Math.max(0,l-200),d=.25*e.width,p=Math.max(20,.15*e.height),h=Math.random()*(e.width-r),g=200+(s>0?Math.random()*s:0);n.push({id:"coin_p".concat(i,"_0_").concat(Date.now()),x:h,y:g,width:r,height:r,collected:!1,isExploding:!1,explosionProgress:0,isSpawning:!0,spawnExplosionProgress:0,pairId:i,isPendingSpawn:!1,spawnDelayMs:0});let u=0;do a=Math.random()*(e.width-r),o=200+(s>0?Math.random()*s:0),u++;while((Math.abs(a-h)<d||Math.abs(o-g)<p)&&u<20);return n.push({id:"coin_p".concat(i,"_1_").concat(Date.now()),x:a,y:o,width:r,height:r,collected:!1,isExploding:!1,explosionProgress:0,isSpawning:!1,spawnExplosionProgress:0,pairId:i,isPendingSpawn:!0,spawnDelayMs:500}),n}let f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:800,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,t=m(r),a=h(e,r,i),o=g(e,r,i,a),n=.75;(2===i||3===i)&&(n=.75);let l=a.map(e=>e.isMoving?{...e,speed:n}:e),s=2===i?7e3:12e3*(3===i);return{hero:{...p,x:e/2-p.width/2,y:t+1,currentSpeedX:0,isArmored:2===i||3===i,armorTimer:s,armorCooldownTimer:0,armorRemainingTime:Math.ceil(s/1e3)},platforms:l,activeCoins:u({width:e,height:r},20,0,l),enemies:o,score:0,currentLevel:i,gameOver:!1,gameLost:!1,gameArea:{width:e,height:r},isGameInitialized:!1,paddingTop:0,heroAppearance:"appearing",heroAppearElapsedTime:0,totalCoinsCollectedInLevel:0,currentPairIndex:0,levelCompleteScreenActive:!1,showDebugLevelComplete:!1,bearVoicePlayedForLevel:!1}},v=f(void 0,void 0,1);function y(e,r){var i,t,a,o,n,l,s,p,h;switch(r.type){case"MOVE_LEFT_START":if("visible"===e.heroAppearance&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return{...e,hero:{...e.hero,currentSpeedX:-1.25,action:"run_left",facingDirection:"left",slideVelocityX:0}};return e;case"MOVE_LEFT_STOP":if("visible"===e.heroAppearance&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return{...e,hero:{...e.hero,currentSpeedX:e.hero.currentSpeedX<0?0:e.hero.currentSpeedX,action:0===e.hero.currentSpeedX&&e.hero.isOnPlatform&&(null!==(t=null===(i=e.hero.velocity)||void 0===i?void 0:i.y)&&void 0!==t?t:0)===0?"idle":e.hero.action}};return e;case"MOVE_RIGHT_START":if("visible"===e.heroAppearance&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return{...e,hero:{...e.hero,currentSpeedX:1.25,action:"run_right",facingDirection:"right",slideVelocityX:0}};return e;case"MOVE_RIGHT_STOP":if("visible"===e.heroAppearance&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return{...e,hero:{...e.hero,currentSpeedX:e.hero.currentSpeedX>0?0:e.hero.currentSpeedX,action:0===e.hero.currentSpeedX&&e.hero.isOnPlatform&&(null!==(o=null===(a=e.hero.velocity)||void 0===a?void 0:a.y)&&void 0!==o?o:0)===0?"idle":e.hero.action}};return e;case"JUMP":if("visible"===e.heroAppearance&&e.hero.isOnPlatform&&!e.levelCompleteScreenActive&&!e.gameLost&&!e.gameOver)return c.W.playSound("Hero_jump1"),{...e,hero:{...e.hero,velocity:{...e.hero.velocity,y:d},isOnPlatform:!1,platformId:null,action:"jump_up"}};return e;case"UPDATE_GAME_AREA":{let{width:i,height:t,paddingTop:a}=r.payload;if(i<=0||t<=0)return e;let o=e.currentLevel>1?e.currentLevel:1;return{...f(i,t,e.isGameInitialized?e.currentLevel:o),paddingTop:a,isGameInitialized:!0,bearVoicePlayedForLevel:!1}}case"RESTART_LEVEL":{let{width:r,height:i}=e.gameArea;return{...f(r,i,e.currentLevel),isGameInitialized:!0,paddingTop:e.paddingTop,levelCompleteScreenActive:!1,gameOver:!1,bearVoicePlayedForLevel:!1}}case"NEXT_LEVEL":{let r=e.currentLevel+1;if(r>3)return c.W.playSound("final_screen"),{...e,gameOver:!0,levelCompleteScreenActive:!1};let{width:i,height:t}=e.gameArea;return{...f(i,t,r),isGameInitialized:!0,paddingTop:e.paddingTop,levelCompleteScreenActive:!1,gameOver:!1,bearVoicePlayedForLevel:!1}}case"GAME_WON":return c.W.playSound("final_screen"),{...e,gameOver:!0,levelCompleteScreenActive:!1};case"SET_DEBUG_LEVEL_COMPLETE":return{...e,levelCompleteScreenActive:r.payload,showDebugLevelComplete:r.payload};case"SET_DEBUG_LEVEL":{let{width:i,height:t}=e.gameArea,a=f(i,t,r.payload);return v=a,{...a,isGameInitialized:!0,paddingTop:e.paddingTop,levelCompleteScreenActive:!1,gameOver:!1,bearVoicePlayedForLevel:!1}}case"GAME_TICK":{if(!e.isGameInitialized||e.levelCompleteScreenActive||e.gameLost||e.gameOver)return e;let{deltaTime:i}=r.payload,{hero:t,platforms:a,activeCoins:o,enemies:d,score:f,totalCoinsCollectedInLevel:v,currentPairIndex:y,bearVoicePlayedForLevel:x}=e,w=e.gameArea,_=e.heroAppearance,A=e.heroAppearElapsedTime,T=a.map(e=>({...e})),b={...t,velocity:{...t.velocity},animations:{...t.animations}},S=o.map(e=>({...e})),E=[...d.map(e=>({...e}))],L=f,M=v,C=y,k=!1,P=!1,O=!1,j=x;(2===e.currentLevel||3===e.currentLevel)&&(b.isArmored?(b.armorTimer-=i,b.armorTimer<=0&&(b.isArmored=!1,b.armorTimer=0,b.armorCooldownTimer=2===e.currentLevel?7e3:1e4)):(b.armorCooldownTimer-=i,b.armorCooldownTimer<=0&&(b.isArmored=!0,b.armorCooldownTimer=0,b.armorTimer=2===e.currentLevel?7e3:12e3)),b.armorRemainingTime=Math.ceil(b.armorTimer/1e3));let z="run_left"===b.action||"run_right"===b.action?"run":"jump_up"===b.action||"fall_down"===b.action?"jump":"idle",I=b.animations[z];b.frameTime+=i,I&&b.frameTime>=1e3/I.fps&&(b.frameTime=0,b.currentFrame=(b.currentFrame+1)%I.frames),S=(S=(S=S.map(e=>{if(e.isPendingSpawn&&void 0!==e.spawnDelayMs){let r=e.spawnDelayMs-i;return r<=0?(c.W.playSound("Coin_splash"),{...e,isPendingSpawn:!1,spawnDelayMs:0,isSpawning:!0,spawnExplosionProgress:0}):{...e,spawnDelayMs:r}}return e})).map(e=>{if(e.isSpawning){let r=(e.spawnExplosionProgress||0)+i/300;return r>=1?{...e,isSpawning:!1,spawnExplosionProgress:1}:{...e,spawnExplosionProgress:r}}return e})).map(e=>{if(e.isExploding&&e.collected){let r=(e.explosionProgress||0)+i/500;return r>=1?{...e,isExploding:!1,explosionProgress:1}:{...e,explosionProgress:r}}return e});let R=m(w.height);if(T=T.map(e=>{if("platform_ground"===e.id)return{...e,y:R};if(e.isMoving&&"platform_ground"!==e.id){let r=e.x,t=e.speed,a=t*e.direction;"x"===e.moveAxis&&e.moveRange&&((r+=i/(1e3/60)*a)<=e.moveRange.min||r+e.width>=e.moveRange.max+e.width)&&(e.direction*=-1,a*=-1,r=Math.max(e.moveRange.min,Math.min(r,e.moveRange.max)));let o=R+1+("platform1"===e.id?200:400);return{...e,x:r,y:o,velocity:{x:a,y:0},speed:t}}return{...e,velocity:{x:0,y:0}}}),E=E.map(r=>{let t={...r},a=e.enemies.find(e=>e.id===r.id);if(t.isDefeated&&void 0!==t.defeatTimer){let e=t.defeatTimer-i;if(!(e<=0))return{...t,defeatTimer:e};t={...t,isDefeated:!1,defeatTimer:0,x:w.width/2-t.width/2,y:t.y,direction:1,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3},a&&a.isDefeated&&!t.isDefeated&&c.W.playSound("bear_voice")}if(t.isFrozen&&void 0!==t.frozenTimer){let e=t.frozenTimer-i;if(!(e<=0))return{...t,frozenTimer:e};t={...t,isFrozen:!1,frozenTimer:0,periodicFreezeIntervalTimer:5e3}}if(!t.isDefeated&&!t.isFrozen&&void 0!==t.periodicFreezeIntervalTimer){let e=t.periodicFreezeIntervalTimer-i;if(e<=0)return{...t,isFrozen:!0,frozenTimer:5e3,periodicFreezeIntervalTimer:5e3};t={...t,periodicFreezeIntervalTimer:e}}if(!t.isDefeated&&!t.isFrozen){let e=t.x,r=t.speed,a=r*t.direction;if("x"===t.moveAxis&&t.moveRange&&((e+=i/(1e3/60)*a)<=t.moveRange.min||e+t.width>=t.moveRange.max+t.width)){let r=-1*t.direction;a*=-1,e=Math.max(t.moveRange.min,Math.min(e,t.moveRange.max)),t={...t,direction:r}}t={...t,x:e,velocity:{x:a,y:0},speed:r}}return t}),"appearing"===e.heroAppearance)(A+=i)>=1e3&&(_="visible",A=1e3,b.action="idle"),b.velocity={x:0,y:0},b.currentSpeedX=0,b.facingDirection=t.facingDirection||"right",b.slideVelocityX=0;else{let r;let t=(null!==(s=null===(n=b.velocity)||void 0===n?void 0:n.y)&&void 0!==s?s:0)-i/(1e3/60)*.4;t=Math.max(t,-8);let a=0,o=!1;if(b.isOnPlatform&&b.platformId){let e=T.find(e=>e.id===b.platformId);e&&(e.isMoving&&(null===(p=e.velocity)||void 0===p?void 0:p.x)&&(a=e.velocity.x*(i/(1e3/60))),e.isSlippery&&(o=!0))}let d=0!==b.currentSpeedX?b.currentSpeedX>0?1.25:-1.25:0;o?(0!==b.currentSpeedX?b.slideVelocityX=d:(b.slideVelocityX=.92*(b.slideVelocityX||0),.1>Math.abs(b.slideVelocityX||0)&&(b.slideVelocityX=0)),r=b.x+(b.slideVelocityX||0)*(i/(1e3/60))+a):(b.slideVelocityX=0,r=b.x+i/(1e3/60)*d+a);let m=b.y+i/(1e3/60)*t;t<-.2?b.action="fall_down":t>0?b.action="jump_up":0!==b.currentSpeedX&&b.isOnPlatform?b.action="right"===b.facingDirection?"run_right":"run_left":b.isOnPlatform&&(0===b.slideVelocityX||!o)?b.action="idle":b.isOnPlatform&&o&&0!==b.slideVelocityX&&(b.action=b.slideVelocityX>0?"run_right":"run_left");let f=!1,v=null,x=t,z=b.y;for(let e of T){let i=r,t=r+b.width,a=m,o=m+b.height,n=e.y+e.height,l=e.y,s=e.x;if(i<e.x+e.width&&t>s){if(x<=0&&z>=n&&a<=n){m=n,x=0,f=!0,v=e.id,("fall_down"===b.action||"jump_up"===b.action)&&(b.action=0!==b.currentSpeedX?"right"===b.facingDirection?"run_right":"run_left":"idle",e.isSlippery&&0===b.currentSpeedX||e.isSlippery||(b.slideVelocityX=0));break}let r=b.y+b.height;x>0&&r<=l&&o>=l&&(m=l-b.height,x=-.2)}}if(b.x=r,b.y=m,b.velocity={x:null!==(h=null===(l=b.velocity)||void 0===l?void 0:l.x)&&void 0!==h?h:0,y:x},b.isOnPlatform=f,b.platformId=v,b.isOnPlatform){let e=T.find(e=>e.id===b.platformId);(null==e?void 0:e.isSlippery)?0===b.currentSpeedX&&.1>Math.abs(b.slideVelocityX||0)?b.action="idle":Math.abs(b.slideVelocityX||0)>=.1&&(b.action=(b.slideVelocityX||0)>0?"run_right":"run_left"):0===b.currentSpeedX&&0===x?b.action="idle":0!==b.currentSpeedX&&0===x&&(b.action="right"===b.facingDirection?"run_right":"run_left")}else x>0?b.action="jump_up":x<-.2&&(b.action="fall_down");b.x<0&&(b.x=0),b.x+b.width>w.width&&(b.x=w.width-b.width),b.y+b.height>w.height&&(b.y=w.height-b.height,b.velocity&&b.velocity.y>0&&(b.velocity.y=0));for(let r=0;r<E.length;r++){let i=E[r];if(i.isDefeated||i.isFrozen)continue;let t=i.x+i.width/2,a=i.y+i.height/2,o=Math.max(b.x,Math.min(t,b.x+b.width)),n=Math.max(b.y,Math.min(a,b.y+b.height)),l=t-o,s=a-n;if(l*l+s*s<i.collisionRadius*i.collisionRadius){b.isArmored||(O=!0,c.W.playSound("Hero_fail"));let t=e.enemies.find(e=>e.id===i.id);t&&!t.isDefeated&&c.W.playSound("bear_voice"),E[r]={...i,isDefeated:!0,defeatTimer:5e3,isFrozen:!1,frozenTimer:0},b.isArmored&&(O=!1);break}}O&&!b.isArmored&&(b.y=R+1,b.x=w.width/2-b.width/2,b.velocity={x:0,y:0},b.isOnPlatform=!0,b.platformId="platform_ground",b.action="idle",_="appearing",A=0,b.slideVelocityX=0);let I=!1,V=0;if(!O||O&&b.isArmored){S=S.map(e=>!e.collected&&!e.isExploding&&!e.isSpawning&&!e.isPendingSpawn&&b.x<e.x+e.width&&b.x+b.width>e.x&&b.y<e.y+e.height&&b.y+b.height>e.y?(I=!0,V++,c.W.playSound("takecoin"),{...e,collected:!0,isExploding:!0,explosionProgress:0}):e);let r=!1;if(I){L+=V;let i=M;if(M+=V,2===e.currentLevel&&0===i&&M>0&&!E.some(e=>"enemy_level2_0"===e.id&&!e.isDefeated)&&!E.find(e=>"enemy_level2_0"===e.id)){let r=g(w.width,w.height,e.currentLevel,T).find(e=>"enemy_level2_0"===e.id);r&&(j||(c.W.playSound("bear_voice"),j=!0),E.push(r))}if(3===e.currentLevel&&0===i&&M>0&&0===E.filter(e=>e.id.startsWith("enemy_level3_")&&!e.isDefeated).length){let r=g(w.width,w.height,e.currentLevel,T),i=!1;r.forEach(e=>{E.some(r=>r.id===e.id)||(E.push(e),i=!0)}),i&&!j&&(c.W.playSound("bear_voice"),j=!0)}if(2===e.currentLevel)E=E.map(e=>"enemy_level2_0"!==e.id||e.isDefeated?e:{...e,isFrozen:!0,frozenTimer:5e3});else if(3===e.currentLevel){let e=M%2==0;E=E.map(r=>("enemy1"!==r.enemyId||!e||r.isDefeated)&&("enemy2"!==r.enemyId||e||r.isDefeated)?r:{...r,isFrozen:!0,frozenTimer:5e3})}let t=S.filter(e=>e.pairId===y);t.length>0&&t.every(e=>e.collected)&&(M<10?(C=y+1,r=!0):(k=!0,c.W.playSound("allcoins")))}S=S.filter(e=>!(e.collected&&!1===e.isExploding&&1===e.explosionProgress)),r&&(S=[...S,...u(w,20,C,T)])}!(b.y<0)||k||O&&!b.isArmored||(P=!0,c.W.playSound("Hero_fail"))}let V=e.gameOver,F=e.levelCompleteScreenActive;return!k||O&&!b.isArmored||P||(3===e.currentLevel?V=!0:F=!0),{...e,hero:b,platforms:T,activeCoins:S,enemies:E,score:L,totalCoinsCollectedInLevel:M,currentPairIndex:C,heroAppearance:_,heroAppearElapsedTime:A,gameOver:V,gameLost:P&&!(O&&!b.isArmored),levelCompleteScreenActive:F,bearVoicePlayedForLevel:j}}case"EXIT_GAME":return{...v=f(e.gameArea.width,e.gameArea.height,1),gameOver:!1,gameLost:!1,levelCompleteScreenActive:!1};default:return e}}var x=i(285),w=i(157);let _=(0,w.A)("CircleArrowLeft",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 12H8",key:"1fr5h0"}],["path",{d:"m12 8-4 4 4 4",key:"15vm53"}]]),A=(0,w.A)("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),T=(0,w.A)("CircleArrowRight",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}]]),b=(0,w.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);function S(e){let{dispatch:r,onExit:i,disabled:a=!1,currentLevel:o}=e,n=e=>{a||r({type:e})},l=e=>{a||r({type:e})},s=e=>{r({type:e})},c="p-3 h-16 w-16 rounded-full text-foreground shadow-lg hover:shadow-xl active:shadow-lg active:translate-y-px transition-all duration-150 ease-in-out",d="disabled:opacity-70 disabled:bg-transparent disabled:border disabled:border-destructive disabled:text-destructive disabled:shadow-none disabled:cursor-not-allowed",m=e=>e?{}:{backgroundImage:"radial-gradient(circle, hsl(var(--destructive)), #e74210, #f48c25 )"};return(0,t.jsxs)("div",{className:"h-full w-full p-2 flex items-center justify-around z-50 touch-manipulation",style:{backgroundImage:(e=>{switch(e){case 1:default:return'url("/assets/images/groundfloor.png")';case 2:return'url("/assets/images/platform_ice.png")';case 3:return'url("/assets/images/platform_metal.png")'}})(o),backgroundSize:"cover",backgroundPosition:"center left",backgroundRepeat:"no-repeat",backgroundColor:"transparent"},"data-ai-hint":"stone texture",children:[(0,t.jsx)(x.$,{variant:"ghost",size:"lg",className:"".concat(c," ").concat(a?d:""),style:m(a),onMouseDown:()=>l("MOVE_LEFT_START"),onMouseUp:()=>s("MOVE_LEFT_STOP"),onTouchStart:()=>l("MOVE_LEFT_START"),onTouchEnd:()=>s("MOVE_LEFT_STOP"),"aria-label":"Move Left",disabled:a,children:(0,t.jsx)(_,{className:"h-12 w-12 text-foreground"})}),(0,t.jsx)(x.$,{variant:"ghost",size:"lg",className:"".concat(c," ").concat(a?d:""),style:m(a),onClick:()=>n("JUMP"),"aria-label":"Jump",disabled:a,children:(0,t.jsx)(A,{className:"h-12 w-12 text-foreground"})}),(0,t.jsx)(x.$,{variant:"ghost",size:"lg",className:"".concat(c," ").concat(a?d:""),style:m(a),onMouseDown:()=>l("MOVE_RIGHT_START"),onMouseUp:()=>s("MOVE_RIGHT_STOP"),onTouchStart:()=>l("MOVE_RIGHT_START"),onTouchEnd:()=>s("MOVE_RIGHT_STOP"),"aria-label":"Move Right",disabled:a,children:(0,t.jsx)(T,{className:"h-12 w-12 text-foreground"})}),(0,t.jsx)(x.$,{variant:"ghost",size:"lg",className:"".concat(c," ").concat(a?d:""),style:m(a),onClick:i,"aria-label":"Выход в меню",disabled:a,children:(0,t.jsx)(b,{className:"h-12 w-12 text-foreground"})})]})}var E=i(9434);function L(e){let{x:r,y:i,width:t,height:a,gameAreaHeight:o,paddingTop:n,color:l,heroAction:s,heroFacingDirection:c,appearanceProps:d,shape:m="rect",isHero:p=!1,isPlatform:h=!1,isEnemy:g=!1}=e,u={position:"absolute",left:"".concat(r,"px"),top:"".concat(n+(o-i-a),"px"),width:"".concat(t,"px"),height:"".concat(a,"px"),objectFit:"fill",transition:"opacity 0.2s ease-out, transform 0.2s ease-out, filter 0.2s ease-out"};l&&!g&&(u.backgroundColor=l);let f="";p&&(f="left"===c?"scaleX(-1)":"scaleX(1)");let v="";if((null==d?void 0:d.type)==="heroAppear"){let e=d.progress;u.opacity=e,v="scale(".concat(e,")"),u.transformOrigin="center bottom",u.borderRadius="2px"}else if("circle"===m?u.borderRadius="50%":g||(u.borderRadius="2px"),s)switch(s){case"jump_up":v="scaleY(0.95) translateY(-3px) scaleX(1.05)",u.transition="transform 0.1s ease-out";break;case"fall_down":v="scaleY(1.05) translateY(1px) scaleX(0.95)",u.transition="transform 0.1s ease-in";break;default:v=""}let y="".concat(f," ").concat(v).trim();return y&&(u.transform=y),u}function M(e){let r,{hero:i,gameAreaHeight:a,paddingTop:o,heroAppearance:n,heroAppearElapsedTime:l,heroAppearanceDuration:s}=e;if(!a&&0!==a)return null;"appearing"===n&&(r={type:"heroAppear",progress:Math.min(1,l/s)});let c=i.animations.idle.src,d=i.animations.run.src,m=i.animations.jump.src,p=c,h="character fantasy";"run_left"===i.action||"run_right"===i.action?(p=d,h="character running"):("jump_up"===i.action||"fall_down"===i.action)&&(p=m,h="character jumping");let g=L({...i,gameAreaHeight:a,paddingTop:o,heroAction:i.action,heroFacingDirection:i.facingDirection,appearanceProps:r,isHero:!0}),u=[];return i.isArmored&&u.push("hero-armored"),(0,t.jsx)("img",{src:p,alt:"Hero",style:g,className:(0,E.cn)(u),role:"img","aria-label":"Hero","data-ai-hint":h})}function C(e){let{platform:r,gameAreaHeight:i,paddingTop:a}=e;if(!i&&0!==i)return null;let o={...L({...r,gameAreaHeight:i,paddingTop:a,color:void 0,shape:"rect",isPlatform:!0}),backgroundImage:"url(".concat(r.imageSrc||n,")"),backgroundSize:"platform_ground"===r.id?"auto 100%":"100% 100%",backgroundPosition:"platform_ground"===r.id?"left bottom":"center",backgroundRepeat:"platform_ground"===r.id?"repeat-x":"no-repeat",boxShadow:"none",border:"none"},l="grass platform";return r.imageSrc&&(r.imageSrc.includes("groundfloor")?l="stone ground":r.imageSrc.includes("ice")?l="ice platform":r.imageSrc.includes("stone")?l="stone platform":r.imageSrc.includes("grass")&&(l="grass platform")),(0,t.jsx)("div",{style:o,role:"presentation","data-ai-hint":l})}function k(e){let{coin:r,gameAreaHeight:i,paddingTop:a}=e;if(!i&&0!==i)return null;let o=L({...r,gameAreaHeight:i,paddingTop:a,shape:"circle"});if(r.isSpawning&&null!=r.spawnExplosionProgress&&r.spawnExplosionProgress<1){let e=[];for(let i=0;i<8;i++){let a=i/8*2*Math.PI+(Math.random()-.5)*.5,o=40*r.spawnExplosionProgress*(.5+.5*Math.random()),n=Math.cos(a)*o,l=Math.sin(a)*o,s={position:"absolute",left:"calc(50% + ".concat(n,"px - ").concat(2.5,"px)"),top:"calc(50% + ".concat(l,"px - ").concat(2.5,"px)"),width:"".concat(5,"px"),height:"".concat(5,"px"),backgroundColor:"hsl(var(--accent))",borderRadius:"50%",opacity:1-r.spawnExplosionProgress,transform:"scale(".concat(1-r.spawnExplosionProgress,")"),transition:"opacity 0.1s ease-out, transform 0.1s ease-out"};e.push((0,t.jsx)("div",{style:s},"spawn_particle_".concat(i)))}let i={position:"absolute",left:o.left,top:o.top,width:o.width,height:o.height};return(0,t.jsx)("div",{style:i,"aria-label":"Coin Spawning","data-ai-hint":"sparkle effect",children:e})}if(r.isExploding&&r.collected&&null!=r.explosionProgress&&r.explosionProgress<1){let e=[];for(let i=0;i<8;i++){let a=i/8*2*Math.PI+(Math.random()-.5)*.5,o=40*r.explosionProgress*(.5+.5*Math.random()),n=Math.cos(a)*o,l=Math.sin(a)*o,s={position:"absolute",left:"calc(50% + ".concat(n,"px - ").concat(2.5,"px)"),top:"calc(50% + ".concat(l,"px - ").concat(2.5,"px)"),width:"".concat(5,"px"),height:"".concat(5,"px"),backgroundColor:"hsl(var(--coin-color))",borderRadius:"50%",opacity:1-r.explosionProgress,transform:"scale(".concat(1-r.explosionProgress,")"),transition:"opacity 0.1s ease-out, transform 0.1s ease-out"};e.push((0,t.jsx)("div",{style:s},"collect_particle_".concat(i)))}let i={position:"absolute",left:o.left,top:o.top,width:o.width,height:o.height};return(0,t.jsx)("div",{style:i,"aria-label":"Coin Exploding","data-ai-hint":"gold sparkle",children:e})}return r.collected||r.isSpawning?null:(0,t.jsx)("img",{src:"/assets/images/thankscoin.png",alt:"Coin",className:"animate-rotate-y",style:{...o,transformStyle:"preserve-3d",boxShadow:"2px 2px 3px rgba(0,0,0,0.2), inset 0 0 2px rgba(255,255,255,0.3)"},role:"img","aria-label":"Coin","data-ai-hint":"gold coin"})}function P(e){let{enemy:r,gameAreaHeight:i,paddingTop:a}=e;if(!i&&0!==i||r.isDefeated&&r.defeatTimer>0)return null;let o=L({...r,gameAreaHeight:i,paddingTop:a,isEnemy:!0,isDefeated:r.isDefeated});return(0,t.jsx)("img",{src:r.imageSrc,alt:"Enemy",style:o,role:"img","aria-label":"Enemy","data-ai-hint":"enemy2"===r.enemyId?"dark bear face":"bear face"})}var O=i(6364),j=i(1575),z=i(10);function I(){var e;let{gameState:r,dispatch:i,gameTick:n}=function(){let[e,r]=(0,a.useReducer)(y,v),i=(0,a.useRef)(performance.now()),t=(0,a.useCallback)(()=>{let e=performance.now(),t=e-i.current;i.current=e,r({type:"GAME_TICK",payload:{deltaTime:t}})},[]),o=(0,a.useCallback)(e=>{r(e)},[]);return(0,a.useEffect)(()=>{e.gameArea.width>0&&e.gameArea.height>0&&!e.isGameInitialized&&r({type:"UPDATE_GAME_AREA",payload:{width:e.gameArea.width,height:e.gameArea.height,paddingTop:e.paddingTop}})},[e.gameArea.width,e.gameArea.height,e.isGameInitialized,e.paddingTop]),{gameState:e,dispatch:o,gameTick:t}}(),l=(0,a.useRef)(null),s=(0,a.useRef)(),d=(0,o.useRouter)(),[m,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),[u,f]=(0,a.useState)(!1),[w,_]=(0,a.useState)(!1);(0,a.useEffect)(()=>{},[i]);let A=(0,a.useCallback)(()=>{if(l.current){let{clientWidth:e,clientHeight:r}=l.current;i({type:"UPDATE_GAME_AREA",payload:{width:e,height:r,paddingTop:0}})}},[i]);(0,a.useEffect)(()=>(A(),window.addEventListener("resize",A),()=>{window.removeEventListener("resize",A),c.W.stopAllSounds(),s.current&&cancelAnimationFrame(s.current)}),[A]),(0,a.useEffect)(()=>{if(r.isGameInitialized){c.W.stopAllSounds(),c.W.playSound("New_level");let e={1:"Level1",2:"Level2",3:"Level3"}[r.currentLevel];e&&c.W.getCurrentPlayingLoop()!==e&&setTimeout(()=>{r.isGameInitialized&&r.currentLevel===parseInt(e.replace("Level",""))&&c.W.playSound(e)},500)}},[r.currentLevel,r.isGameInitialized]);let T=(0,a.useCallback)(()=>{!r.isGameInitialized||!(r.gameArea.width>0)||!(r.gameArea.height>0)||r.levelCompleteScreenActive||r.gameOver||r.gameLost||w||n(),s.current=requestAnimationFrame(T)},[n,r.isGameInitialized,r.gameArea.width,r.gameArea.height,r.levelCompleteScreenActive,r.gameOver,r.gameLost,w]);(0,a.useEffect)(()=>(w?s.current&&cancelAnimationFrame(s.current):s.current=requestAnimationFrame(T),()=>{s.current&&cancelAnimationFrame(s.current)}),[T,w]),(0,a.useEffect)(()=>{let e=e=>{if(u||m||"appearing"===r.heroAppearance||r.levelCompleteScreenActive||r.gameLost||r.gameOver||"F5"===e.key||e.ctrlKey&&"r"===e.key.toLowerCase()||e.ctrlKey&&e.shiftKey&&"i"===e.key.toLowerCase()||e.metaKey&&e.altKey&&"i"===e.key.toLowerCase()||"F12"===e.key)return;let t=!1;switch(e.key.toLowerCase()){case"arrowleft":case"a":i({type:"MOVE_LEFT_START"}),t=!0;break;case"arrowright":case"d":i({type:"MOVE_RIGHT_START"}),t=!0;break;case"arrowup":case"w":case" ":i({type:"JUMP"}),t=!0}t&&e.preventDefault()},t=e=>{if(u||m||"appearing"===r.heroAppearance||r.levelCompleteScreenActive||r.gameLost||r.gameOver)return;let t=!1;switch(e.key.toLowerCase()){case"arrowleft":case"a":i({type:"MOVE_LEFT_STOP"}),t=!0;break;case"arrowright":case"d":i({type:"MOVE_RIGHT_STOP"}),t=!0}t&&e.preventDefault()};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),i({type:"MOVE_LEFT_STOP"}),i({type:"MOVE_RIGHT_STOP"})}},[i,r.heroAppearance,r.levelCompleteScreenActive,r.gameLost,r.gameOver,m,u]);let b=async()=>{c.W.stopAllSounds(),c.W.playSound("exit"),f(!1),_(!1),setTimeout(()=>{d.push("/")},300)},E=()=>{f(!1),_(!1)};return m?(0,t.jsx)(j.V,{}):r.gameLost?(0,t.jsxs)("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-background text-foreground p-4",children:[(0,t.jsx)("h2",{className:"text-4xl font-bold mb-4 text-destructive",children:"Игра окончена!"}),(0,t.jsx)("p",{className:"text-xl mb-8 text-center",children:"Кажется, наш герой немного увлекся полетом..."}),(0,t.jsx)(x.$,{onClick:()=>{c.W.stopAllSounds(),i({type:"RESTART_LEVEL"})},size:"lg",className:"text-lg px-8 py-3 bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:"Начать сначала"}),(0,t.jsx)(x.$,{onClick:b,variant:"outline",size:"lg",className:"mt-4 text-lg px-8 py-3 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200",children:"Главное меню"})]}):r.levelCompleteScreenActive||h?(0,t.jsx)(O.M,{currentLevel:r.currentLevel,onNextLevel:()=>{c.W.stopAllSounds(),i({type:"NEXT_LEVEL"}),h&&g(!1)}}):r.gameOver&&3===r.currentLevel&&!r.gameLost?(0,t.jsx)(j.V,{}):(0,t.jsxs)("div",{className:"h-screen w-screen flex flex-col overflow-hidden select-none",style:{backgroundColor:"hsl(var(--background))",paddingBottom:"0px",boxSizing:"border-box"},"aria-label":"Главное окно игры",children:[(0,t.jsxs)("header",{className:"absolute top-0 left-0 right-0 p-4 flex justify-between items-center z-10 pointer-events-none",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-roboto text-2xl font-bold text-white shadow-md",children:"IPO Mad Racing"}),(null===(e=r.hero)||void 0===e?void 0:e.isArmored)&&r.hero.armorRemainingTime>0&&(0,t.jsxs)("p",{className:"text-xs font-normal text-accent font-roboto shadow-md",children:["Броня: ",r.hero.armorRemainingTime,"с"]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-end",children:[(0,t.jsxs)("p",{className:"text-xs font-normal text-white font-roboto shadow-md",children:["Level: ",r.currentLevel]}),(0,t.jsxs)("p",{className:"text-xs font-normal text-white font-roboto shadow-md",children:["Спасибки: ",r.score]})]})]}),(0,t.jsx)("div",{ref:l,className:"relative w-full overflow-hidden flex-grow bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(".concat((e=>{switch(e){case 1:default:return"/assets/images/level1_bkg.png";case 2:return"/assets/images/level2_bkg.png";case 3:return"/assets/images/level3_bkg.png"}})(r.currentLevel),")"),backgroundSize:"cover",backgroundPosition:3===r.currentLevel?"top right":"top center",height:"calc(100% - 10vh)"},"data-ai-hint":"abstract pattern",children:r.isGameInitialized&&r.gameArea.height>0&&r.hero&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M,{hero:r.hero,gameAreaHeight:r.gameArea.height,paddingTop:r.paddingTop,heroAppearance:r.heroAppearance,heroAppearElapsedTime:r.heroAppearElapsedTime,heroAppearanceDuration:1e3}),r.platforms.map(e=>(0,t.jsx)(C,{platform:e,gameAreaHeight:r.gameArea.height,paddingTop:r.paddingTop},e.id)),r.activeCoins.map(e=>(0,t.jsx)(k,{coin:e,gameAreaHeight:r.gameArea.height,paddingTop:r.paddingTop},e.id)),r.enemies.map(e=>(0,t.jsx)(P,{enemy:e,gameAreaHeight:r.gameArea.height,paddingTop:r.paddingTop},e.id))]})}),(0,t.jsx)(z.Lt,{open:u,onOpenChange:e=>{!e&&w?E():e&&!u&&(f(!0),_(!0))},children:(0,t.jsxs)(z.EO,{children:[(0,t.jsxs)(z.wd,{className:"items-center",children:[(0,t.jsx)("div",{className:"relative w-24 h-24 mb-4 bg-contain bg-no-repeat bg-center",style:{backgroundImage:"url(/assets/images/SimplyMan.png)"},role:"img","aria-label":"Simply Man","data-ai-hint":"man thinking cartoon"}),(0,t.jsx)(z.r7,{children:"Вы действительно хотите покинуть игру?"})]}),(0,t.jsxs)(z.ck,{className:"flex-col-reverse sm:flex-col-reverse gap-y-2.5",children:[(0,t.jsx)(x.$,{variant:"destructive",onClick:E,className:"w-full sm:w-auto",children:"Нет, остаться"}),(0,t.jsx)(x.$,{variant:"secondary",onClick:b,className:"w-full sm:w-auto",children:"Да, покинуть"})]})]})}),(0,t.jsx)("div",{className:"w-full shrink-0",style:{height:"10vh"},children:(0,t.jsx)(S,{dispatch:i,onExit:()=>{_(!0),f(!0)},disabled:"appearing"===r.heroAppearance||r.levelCompleteScreenActive||r.gameLost||r.gameOver||u,currentLevel:r.currentLevel})})]})}},3738:(e,r,i)=>{Promise.resolve().then(i.bind(i,599))}},e=>{var r=r=>e(e.s=r);e.O(0,[797,576,933,441,684,358],()=>r(3738)),_N_E=e.O()}]);